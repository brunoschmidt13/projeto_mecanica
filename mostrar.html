<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/mostrar.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="favicon.png">
    <title>Autoteste - Consulta</title>
</head>

<body>
    <div class="container">
        <h1 id="titulo">Consultando...</h1>
        <div id="resultado"></div>
        <a href="index.html" class="submit-button" style="margin-top: 24px; display: inline-block;">Nova Consulta</a>
    </div>

    <script>
        fetch("src/obter_resultado.php")
            .then(res => res.json())
            .then(data => {
                const container = document.getElementById('resultado');
                const titulo = document.getElementById('titulo');

                if (data.length === 0) {
                    titulo.innerText = "Nenhuma manutenção encontrada.";
                    return;
                }

                titulo.innerText = "Histórico do Veículo: Placa " + (data[0].placa || 'desconhecida');

                let tabela = `<table border="1" cellpadding="10" style="width:100%; background: rgba(255,255,255,0.1); border-radius:10px; color:white;">
                                <tr>
                                    <th>Veículo</th>
                                    <th>Cliente</th>
                                    <th>Data</th>
                                    <th>Serviço</th>
                                </tr>`;

                data.forEach(l => {
                    tabela += `<tr>
                        <td>${l.veiculo || 'Não informado'}</td>
                        <td>${l.nome || 'Não informado'}</td>
                        <td>${l.data_manut || 'Sem data'}</td>
                        <td>${l.servico || 'Não informado'}</td>
                    </tr>`;
                });

                tabela += "</table>";
                container.innerHTML = tabela;
            })
            .catch(err => {
                document.getElementById('titulo').innerText = "Erro ao carregar dados.";
            });
    </script>
</body>

</html>